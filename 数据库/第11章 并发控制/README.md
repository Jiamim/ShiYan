并发控制
========
并发控制保证事务的**隔离性和一致性**。
>###并发与并行
要完成吃完三个馒头的任务：
- 一个人可以这个馒头咬一口，那个馒头咬一口，这样交替进行，最后吃完三个馒头，这就是并发。
- 三个馒头如果分给三个人吃，这样的任务完成形式叫并行。

##并发控制带来的不一致性
有三种：
- 丢失修改
- 不可重复读
- 读“脏”数据

##封锁
基本的封锁类型有两种：
|封锁类型|别名|描述
|-----|----|-----
|排它锁|写锁、X锁|若事务T对数据对象A加上X锁，则只允许T读取和修改A，其他任何事务都不能再对A加任何类型的锁，直到T释放A上的锁。
|共享锁|读锁、S锁|若事务T对数据对象A加上S锁，则事务T可以读A但不能修改A，其他事务职能再对A加S锁，而不能加X锁，直到T释放A上S锁。

可以用相容矩阵来表示X锁和S锁的关系

|T`1` \ T`2`|X|S|-
|:---------:|:---:|:---:|:---:
|X|No|No|Yes
|S|No|Yes|Yes
|-|Yes|Yes|Yes
最左边一列表示T`1`已经获得数据对象上锁的类型。  
最上面一行表示T`2`对同一数据对象发送的封锁请求。  
其中`-`表示没有加锁。