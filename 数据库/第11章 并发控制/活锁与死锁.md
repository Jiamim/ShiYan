活锁与死锁
======
##活锁
避免活锁的简单方法是采用**先来先服务**的策略。
##死锁
解决死锁问题主要有两类方法：
- 采取一定措施预防死锁的发生
- 允许发生死锁，采用一定手段定期诊断系统中有无死锁，若有则解除之

###死锁的预防
在数据库中，死锁产生的原因是两个或多个事务都已封锁了一些数据对象，然后又都请求对已为其他事务封锁的数据对象加锁。  

预防死锁的方法：
####1. 一次封锁法
一次封锁法要求每个事务必须将所有要使用的数据全部加锁，否则就不能继续执行。
####2. 顺序封锁法
顺序封锁法是预先对数据对象规定一个封锁顺序，所有事务都按这个顺序实行封锁。

DBMS在在解决死锁问题上普遍采用的是诊断并解除死锁的方法
###死锁的诊断和解除
####诊断
诊断有两种方法：

**1. 超时法  **  
如果一个事务的等待时间超过了规定的时限，就认为发生了死锁。
**2. 等待图法**  
事务等待图是一个有向图 **G = (T,U)**。T为结点的集合，每个结点表示正在运行的事务；U为边的集合，每条边表示事务等待的情况。
若T1 等待 T2，则T1和T2之间划一条有向边，由T1指向T2.

####解除
通常采用的方法是选择一个处理死锁代价最小的事务，将其撤销，释放此事务持有的所有的锁，使其他事务得以继续运行下去。  
>当然，对撤销的事务所执行的数据修改操作必须加以恢复